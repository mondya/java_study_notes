# WireShark

## 过滤规则

### 按IP地址过滤

查看源ip

==ip.src == 192.168.1.1==

查看目的ip

==ip.dst == 192.168.1.1==

查看源或目标ip

==ip.addr ==  192.168.1.1==

### 按MAC地址过滤

查看源mac

==eth.src == 84-A9-38-6E-0C-06==

查看目的mac

==eth.dst == 84-A9-38-6E-0C-06==

查看源或目标mac

==eth.addr == 84-A9-38-6E-0C-06==

### 按端口过滤

过滤源端口为4694的包

==tcp.srcport == 4096==

过滤目的端口为4096的包

==tcp.dstport == 4096==

过滤端口为4096的包

==tcp.port == 4096==

### 按协议过滤

直接在输入框输入协议名称

### 规则组合

==and==，==or==，非：==!==

## ping网络常见故障

![image-20241201202035351](https://gitee.com/cnuto/images/raw/master/image/image-20241201202035351.png)

icmp，测试网络连通性。ping不通，告诉原因，用icmp包中的type+code，两个数字的组合，代表故障原因。

- 网关设备1没配网关：传输失败，常见故障。
- 网关设备1配了网关，但是找不到网关：来自本机的回复，无法访问目标主机。（自己发arp寻找网关mac失败）
- 网关设备1配了网关，也能找到网关：来自网关的回复，无法访问目标网络。（网关设备缺少路由）
- 网关设备1配了网关，也能找到网关，网关也有目标路由。但是网关设备2设备缺少路由。
  - 网关设备2，有回包的路由，没有目的地的路由：来自缺路由的设备，无法访问目标网络。
  - 网关设备2，没有回包的路由，没有目的地的路由：超时。
- 网关设备1和网关设备2全部配置，但是源主机Ping目的主机超时，目的主机ping源主机能够正常Ping通，目的主机存在防火墙。

### ICMP报文

| Type | code | 描述                           |
| ---- | ---- | ------------------------------ |
| 0    | 0    | Echo Reply(代表一个Ping回应)   |
| 3    | 0    | 网络不可达(缺路由)             |
| 3    | 1    | 主机不可达(不缺路由，缺arp)    |
| 3    | 2    | 协议不可达                     |
| 3    | 3    | 端口不可达                     |
| 5    | 0    | 重定向                         |
| 8    | 0    | Echo Request(代表一个ping请求) |

